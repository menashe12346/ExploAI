import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import classification_report

# ğŸ“¥ ×˜×¢×™× ×ª ×”× ×ª×•× ×™×
df = pd.read_csv("/home/menashe/cyber_ai_project/datasets/exploits/exploitdb/matches.csv")

# ğŸ¯ ×”×’×“×¨×ª ××˜×¨×ª ×”× ×™×‘×•×™
y = df["exploit_type"]
X = df[["os_vendor", "os_name", "os_version"]].copy()

# ğŸ›ï¸ ×§×™×“×•×“ ×˜×§×¡×˜×™× ×œ×¢×¨×›×™× ××¡×¤×¨×™×™×
le_vendor = LabelEncoder()
le_name = LabelEncoder()
le_version = LabelEncoder()
le_type = LabelEncoder()

X["os_vendor"] = le_vendor.fit_transform(X["os_vendor"])
X["os_name"] = le_name.fit_transform(X["os_name"])
X["os_version"] = le_version.fit_transform(X["os_version"])
y = le_type.fit_transform(y)

# âœ‚ï¸ ×—×œ×•×§×” ×œ-Train/Test
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# ğŸ¤– ××™××•×Ÿ ×”××•×“×œ
clf = RandomForestClassifier(n_estimators=100, random_state=42)
clf.fit(X_train, y_train)

# ğŸ” ×”×¢×¨×›×ª ×‘×™×¦×•×¢×™×
y_pred = clf.predict(X_test)
print("ğŸ“ˆ ×ª×•×¦××•×ª ×¢×œ ×§×‘×•×¦×ª ×”×‘×“×™×§×”:")
print(classification_report(y_test, y_pred, target_names=le_type.classes_))
